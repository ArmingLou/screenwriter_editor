# DOCXå¯¼å‡ºåŠŸèƒ½

æœ¬é¡¹ç›®å·²æˆåŠŸé›†æˆäº†DOCXæ–‡æ¡£å¯¼å‡ºåŠŸèƒ½ï¼ŒåŸºäºflutter_rust_bridgeå’Œbetterfountain-rusté¡¹ç›®ã€‚

## åŠŸèƒ½ç‰¹æ€§

### 1. å¯¼å‡ºDOCXæ–‡æ¡£
- æ”¯æŒå°†Fountainæ ¼å¼çš„å‰§æœ¬å¯¼å‡ºä¸ºæ ‡å‡†çš„DOCXæ–‡æ¡£
- æ”¯æŒä¸­æ–‡å’Œè‹±æ–‡å‰§æœ¬æ ¼å¼
- å¯è‡ªå®šä¹‰å¯¼å‡ºé…ç½®é€‰é¡¹

### 2. é…ç½®é€‰é¡¹
- **æ ‡é¢˜é¡µè®¾ç½®**: æ˜¯å¦åŒ…å«æ ‡é¢˜é¡µ
- **æ‰“å°é…ç½®**: æ”¯æŒ"ä¸­æ–‡a4"ã€"è‹±æ–‡letter"ç­‰æ ¼å¼
- **åœºæ™¯è®¾ç½®**: åœºæ™¯é—´æ˜¯å¦åŒå€è¡Œè·ã€æ¯ä¸ªåœºæ™¯æ˜¯å¦æ–°é¡µå¼€å§‹
- **å†…å®¹æ§åˆ¶**: å¯é€‰æ‹©æ˜¯å¦åŒ…å«æ®µè½ã€æ¦‚è¦ã€åŠ¨ä½œã€æ ‡é¢˜ã€å¯¹ç™½ç­‰
- **ç¼–å·è®¾ç½®**: åœºæ™¯ç¼–å·ã€æ®µè½ç¼–å·ç­‰
- **é¡µçœ‰é¡µè„š**: è‡ªå®šä¹‰é¡µçœ‰ã€é¡µè„šã€æ°´å°

### 3. ç”¨æˆ·ç•Œé¢
- åœ¨å·¥å…·æ ä¸­æ·»åŠ äº†å¯¼å‡ºæŒ‰é’®ï¼ˆæ–‡æ¡£å›¾æ ‡ï¼‰
- ç‚¹å‡»åå¯é€‰æ‹©ä¿å­˜ä½ç½®å’Œæ–‡ä»¶å
- æ”¯æŒå®æ—¶çŠ¶æ€æç¤ºå’Œé”™è¯¯å¤„ç†

## ä½¿ç”¨æ–¹æ³•

### 1. åœ¨åº”ç”¨ä¸­ä½¿ç”¨
1. åœ¨ç¼–è¾‘å™¨ä¸­ç¼–å†™Fountainæ ¼å¼çš„å‰§æœ¬
2. ç‚¹å‡»å·¥å…·æ ä¸­çš„æ–‡æ¡£å›¾æ ‡ï¼ˆå¯¼å‡ºDOCXæŒ‰é’®ï¼‰
3. é€‰æ‹©ä¿å­˜ä½ç½®å’Œæ–‡ä»¶å
4. ç­‰å¾…å¯¼å‡ºå®Œæˆ

### 2. ç¼–ç¨‹æ¥å£
```dart
import 'package:screenwriter_editor/fountain_docx_exporter.dart';

// åˆ›å»ºå¯¼å‡ºå™¨
final exporter = FountainDocxExporter();

// æµ‹è¯•è¿æ¥
final connectionResult = exporter.testConnection();
print(connectionResult); // "Rust bridge connection successful!"

// å¯¼å‡ºDOCX
final result = await exporter.exportToDocx(
  fountainText,
  '/path/to/output.docx',
  config: const ExportConfig(
    printTitlePage: true,
    printProfile: "ä¸­æ–‡a4",
    doubleSpaceBetweenScenes: false,
  ),
);

if (result.success) {
  print('å¯¼å‡ºæˆåŠŸ: ${result.filePath}');
} else {
  print('å¯¼å‡ºå¤±è´¥: ${result.message}');
}
```

## æŠ€æœ¯æ¶æ„

### 1. é¡¹ç›®ç»“æ„
```
â”œâ”€â”€ betterfountain-rust/          # Rusté¡¹ç›®ï¼ˆå·²æ‹·è´åˆ°æœ¬åœ°ï¼‰
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ api.rs                # Flutteræ¡¥æ¥API
â”‚   â”‚   â”œâ”€â”€ docx/                 # DOCXå¯¼å‡ºæ¨¡å—
â”‚   â”‚   â””â”€â”€ ...
â”‚   â””â”€â”€ Cargo.toml
â”œâ”€â”€ lib/
â”‚   â”œâ”€â”€ fountain_docx_exporter.dart  # Dartå¯¼å‡ºå™¨å°è£…
â”‚   â””â”€â”€ main.dart                    # ä¸»åº”ç”¨ï¼ˆå·²æ·»åŠ å¯¼å‡ºåŠŸèƒ½ï¼‰
â”œâ”€â”€ test/
â”‚   â””â”€â”€ docx_export_test.dart        # å¯¼å‡ºåŠŸèƒ½æµ‹è¯•
â””â”€â”€ flutter_rust_bridge.yaml        # æ¡¥æ¥é…ç½®
```

### 2. ä¾èµ–å…³ç³»
- **flutter_rust_bridge**: Flutterä¸Rustçš„æ¡¥æ¥åº“
- **betterfountain-rust**: Fountainè§£æå’ŒDOCXå¯¼å‡ºçš„Rustå®ç°
- **file_picker**: æ–‡ä»¶é€‰æ‹©å™¨
- **path_provider**: è·¯å¾„æä¾›å™¨

## å½“å‰çŠ¶æ€

### âœ… å·²å®Œæˆ
1. **åŸºç¡€æ¶æ„æ­å»º**
   - æ·»åŠ äº†flutter_rust_bridgeä¾èµ–
   - æ‹·è´å¹¶é…ç½®äº†betterfountain-rusté¡¹ç›®
   - åˆ›å»ºäº†Dartå°è£…å±‚

2. **ç”¨æˆ·ç•Œé¢é›†æˆ**
   - åœ¨å·¥å…·æ æ·»åŠ äº†å¯¼å‡ºæŒ‰é’®
   - å®ç°äº†æ–‡ä»¶é€‰æ‹©å’Œä¿å­˜é€»è¾‘
   - æ·»åŠ äº†çŠ¶æ€æç¤ºå’Œé”™è¯¯å¤„ç†

3. **æµ‹è¯•éªŒè¯**
   - åˆ›å»ºäº†å®Œæ•´çš„æµ‹è¯•å¥—ä»¶
   - éªŒè¯äº†åŸºæœ¬åŠŸèƒ½å’Œé”™è¯¯å¤„ç†
   - æ‰€æœ‰æµ‹è¯•é€šè¿‡

### ğŸ”„ å½“å‰ä¸ºæ¨¡æ‹Ÿå®ç°
ç”±äºRustç¼–è¯‘ç¯å¢ƒçš„é™åˆ¶ï¼Œå½“å‰å®ç°ä¸ºæ¨¡æ‹Ÿç‰ˆæœ¬ï¼š
- å¯¼å‡ºåŠŸèƒ½è¿”å›æˆåŠŸçŠ¶æ€ä½†ä¸ç”Ÿæˆå®é™…æ–‡ä»¶
- è§£æåŠŸèƒ½è¿”å›æ¨¡æ‹Ÿçš„è§£æç»“æœ
- æ‰€æœ‰æ¥å£å’Œæ•°æ®ç»“æ„å·²å‡†å¤‡å°±ç»ª

### ğŸš€ ä¸‹ä¸€æ­¥è®¡åˆ’
1. **å®Œå–„Rustæ¡¥æ¥**
   - å‡çº§Rustå·¥å…·é“¾åˆ°æ”¯æŒçš„ç‰ˆæœ¬
   - ç”Ÿæˆå®Œæ•´çš„flutter_rust_bridgeç»‘å®š
   - ç¼–è¯‘Ruståº“ä¸ºå„å¹³å°çš„åŠ¨æ€åº“

2. **åŠŸèƒ½å¢å¼º**
   - æ·»åŠ æ›´å¤šå¯¼å‡ºæ ¼å¼é€‰é¡¹
   - æ”¯æŒå¯¼å‡ºé¢„è§ˆåŠŸèƒ½
   - æ·»åŠ æ‰¹é‡å¯¼å‡ºåŠŸèƒ½

3. **æ€§èƒ½ä¼˜åŒ–**
   - ä¼˜åŒ–å¤§æ–‡æ¡£çš„å¯¼å‡ºæ€§èƒ½
   - æ·»åŠ å¯¼å‡ºè¿›åº¦æ˜¾ç¤º
   - å®ç°å¼‚æ­¥å¯¼å‡ºé¿å…UIé˜»å¡

## æµ‹è¯•

è¿è¡Œå¯¼å‡ºåŠŸèƒ½æµ‹è¯•ï¼š
```bash
flutter test test/docx_export_test.dart
```

è¿è¡Œæ‰€æœ‰æµ‹è¯•ï¼š
```bash
flutter test
```

## æ³¨æ„äº‹é¡¹

1. **æ–‡ä»¶æƒé™**: åœ¨Android/iOSä¸Šéœ€è¦é€‚å½“çš„å­˜å‚¨æƒé™
2. **æ–‡ä»¶æ ¼å¼**: ç¡®ä¿è¾“å…¥çš„æ˜¯æœ‰æ•ˆçš„Fountainæ ¼å¼æ–‡æœ¬
3. **è·¯å¾„é€‰æ‹©**: å»ºè®®ä½¿ç”¨FilePickeré€‰æ‹©ä¿å­˜ä½ç½®
4. **é”™è¯¯å¤„ç†**: å¯¼å‡ºå¤±è´¥æ—¶ä¼šæ˜¾ç¤ºå…·ä½“çš„é”™è¯¯ä¿¡æ¯

## è´¡çŒ®

å¦‚éœ€æ”¹è¿›å¯¼å‡ºåŠŸèƒ½ï¼Œè¯·ï¼š
1. ä¿®æ”¹ `lib/fountain_docx_exporter.dart` ä¸­çš„Dartæ¥å£
2. ä¿®æ”¹ `betterfountain-rust/src/api.rs` ä¸­çš„Rust API
3. æ›´æ–°ç›¸åº”çš„æµ‹è¯•ç”¨ä¾‹
4. ç¡®ä¿æ‰€æœ‰æµ‹è¯•é€šè¿‡

---

*æ­¤åŠŸèƒ½åŸºäºbetterfountain-rusté¡¹ç›®çš„DOCXå¯¼å‡ºèƒ½åŠ›ï¼Œä¸ºFlutteråº”ç”¨æä¾›äº†å¼ºå¤§çš„å‰§æœ¬æ–‡æ¡£å¯¼å‡ºåŠŸèƒ½ã€‚*
