# 剧本编辑器测试工具

本目录包含用于测试剧本编辑器功能的工具。

## PC客户端模拟器

`pc_client_simulator.dart` 是一个简单的命令行工具，用于模拟PC端VSCode扩展的行为，测试与移动端的WebSocket通信。

### 功能

- 连接到移动设备上的WebSocket服务器
- 发送fetch请求获取编辑器内容
- 发送push请求更新编辑器内容
- 交互式命令行界面

### 使用方法

1. 确保移动设备上的剧本编辑器已启动WebSocket服务器
2. 运行模拟器：

```bash
cd your_project_directory
dart run tools/pc_client_simulator.dart
```

3. 按照提示输入服务器IP地址和端口号
4. 连接成功后，使用以下命令：
   - `fetch` 或 `1` - 获取移动端编辑器内容
   - `push` 或 `2` - 推送内容到移动端编辑器
   - `exit` 或 `3` - 退出程序

### 示例会话

```
=== 剧本编辑器 PC客户端模拟器 ===
用于测试与移动端的WebSocket通信
请输入服务器IP地址 (默认: localhost): 192.168.1.100
请输入端口号 (默认: 8080): 8080
正在连接到 ws://192.168.1.100:8080...
已连接到 ws://192.168.1.100:8080

可用命令:
1. fetch - 获取移动端编辑器内容
2. push - 推送内容到移动端编辑器
3. exit - 退出程序
请输入命令: 1
已发送fetch请求

接收到内容:
----------------------------------------
这是一个测试剧本。

INT. 客厅 - 日

主角走进房间。

主角
你好，世界！
----------------------------------------

可用命令:
1. fetch - 获取移动端编辑器内容
2. push - 推送内容到移动端编辑器
3. exit - 退出程序
请输入命令: 2
请输入要推送的内容 (输入END单独一行结束):
这是从PC端推送的新剧本。

INT. 办公室 - 夜

主角坐在电脑前。

主角
(疲惫地)
编程真有趣！
END
已发送push请求，内容长度: 79字符

可用命令:
1. fetch - 获取移动端编辑器内容
2. push - 推送内容到移动端编辑器
3. exit - 退出程序
请输入命令: 3
已断开连接
程序已退出
```

## 注意事项

- 此模拟器仅用于测试，不包含错误恢复和重连机制
- 确保在可信网络环境中使用
- 大文件传输可能需要更长的处理时间
